#!/bin/bash

# Allclean script for temperature analysis project

# Removes all generated files from SLURM jobs and analysis runs



echo "üßπ Starting cleanup of temperature analysis residuals..."

echo "Working directory: $(pwd)"



# Count files before cleanup

total_removed=0



# Function to safely remove files with counting

safe_remove() {

    local pattern="$1"

    local description="$2"

    

    # Find files matching pattern

    files=($(find . -maxdepth 1 -name "$pattern" 2>/dev/null))

    

    if [ ${#files[@]} -gt 0 ]; then

        echo "üóëÔ∏è  Removing ${#files[@]} $description file(s)..."

        for file in "${files[@]}"; do

            echo "   - $(basename "$file")"

            rm -f "$file"

            ((total_removed++))

        done

    else

        echo "‚ÑπÔ∏è  No $description files found"

    fi

}



# Remove SLURM output files (.out)

safe_remove "temp_analysis_*.out" "SLURM output"

safe_remove "*.out" "additional output"



# Remove SLURM error files (.err)  

safe_remove "temp_analysis_*.err" "SLURM error"

safe_remove "*.err" "additional error"



# Remove generated PNG files (temperature plots)

safe_remove "*temperature_history*.png" "temperature plot"

safe_remove "*temp_analysis*.png" "analysis plot"

safe_remove "*.png" "PNG image"



# Remove generated CSV files (temperature data)

safe_remove "temperature_vs_time*.csv" "temperature data CSV"

safe_remove "*temp_analysis*.csv" "analysis CSV"



# Remove VTK error logs

safe_remove "vtk_errors.log" "VTK error log"

safe_remove "*.log" "log"



# Remove any backup files created by editors

safe_remove "*~" "backup"

safe_remove "*.bak" "backup"

safe_remove ".*.swp" "vim swap"



# Remove Python cache files

if [ -d "__pycache__" ]; then

    echo "üóëÔ∏è  Removing Python cache directory..."

    rm -rf "__pycache__"

    ((total_removed++))

fi



safe_remove "*.pyc" "Python compiled"



# Remove any temporary files

safe_remove "temp_*" "temporary"

safe_remove "tmp_*" "temporary"



# Final summary

echo ""

if [ $total_removed -gt 0 ]; then

    echo "‚úÖ Cleanup completed! Removed $total_removed files/directories"

else

    echo "‚ú® Directory already clean - no files to remove"

fi



echo "üìÅ Remaining files:"

ls -la | grep -v "^total" | grep -v "^d" || echo "   (directory is empty)"



echo "üßπ Allclean finished!"

